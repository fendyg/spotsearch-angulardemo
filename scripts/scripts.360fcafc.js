"use strict";angular.module("spotsearchAngularApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","mediaPlayer","LocalStorageModule"]).config(["$routeProvider","localStorageServiceProvider",function(a,b){a.when("/search/artist/:query",{templateUrl:"views/artistsearch.html",controller:"ArtistSearchController"}).when("/search/album/:query",{templateUrl:"views/albumsearch.html",controller:"AlbumSearchController"}).when("/album/:albumId",{templateUrl:"views/album.html",controller:"AlbumController"}).when("/playlists/",{templateUrl:"views/playlist.html",controller:"PlaylistController"}).when("/playlists/:playlistId",{templateUrl:"views/playlist.html",controller:"PlaylistController"}).when("/about",{}).otherwise({redirectTo:"/"}),b.setPrefix("spotsearch-playlist")}]),angular.module("spotsearchAngularApp").factory("searchFactory",["$http",function(a){var b={};return b.getSearchResults=function(b,c){return a.get("https://api.spotify.com/v1/search?q="+b+"&type="+c)},b.getAlbum=function(b){return a.get("https://api.spotify.com/v1/albums/"+b)},b}]),angular.module("spotsearchAngularApp").factory("uuidFactory",[function(){return function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}}]),angular.module("spotsearchAngularApp").controller("SearchController",["$scope","$location",function(a,b){a.types="album",a.runSearch=function(){b.path("/search/"+a.types+"/"+a.searchQuery)}}]),angular.module("spotsearchAngularApp").controller("AlbumSearchController",["$scope","$routeParams","searchFactory",function(a,b,c){a.types="album",a.query=b.query,a.results={},c.getSearchResults(b.query,"album").success(function(b){a.results=b,console.log(b)}).error(function(b){a.status="Unable to load search results: "+b.message})}]),angular.module("spotsearchAngularApp").controller("ArtistSearchController",["$scope","$routeParams","searchFactory",function(a,b,c){a.types="artist",a.query=b.query,a.results={},c.getSearchResults(b.query,"artist").success(function(b){a.results=b,console.log(b)}).error(function(b){a.status="Unable to load search results: "+b.message})}]),angular.module("spotsearchAngularApp").controller("AlbumController",["$scope","$routeParams","searchFactory","uuidFactory","localStorageService",function(a,b,c,d,e){a.results={},c.getAlbum(b.albumId).success(function(b){a.results=b,console.log(b)}).error(function(b){a.status="Unable to load search results: "+b.message}),a.playlists=[],a.selectedTrack=0;for(var f=0;f<e.keys().length;f++)a.playlists.push({id:e.keys()[f],name:e.get(e.keys()[f]).name});a.playTrack=function(b){a.player.load({src:b}),a.player.play()},a.addTrack=function(b,c){if(a.selectedTrack=b-1,"newplaylist"===c)$("#name-new-playlist").modal();else{var d=e.get(c),f=a.results,g=f.tracks.items[a.selectedTrack],h={name:g.name,artist:f.artists[0].name,album:f.name,imageURL:f.images[0].url,trackURL:g.preview_url};d.tracks.push(h),e.set(c,d),console.log(d)}},a.createPlaylist=function(b){$("#name-new-playlist").modal("hide"),$("body").removeClass("modal-open"),$(".modal-backdrop").remove();var c=d(),f=a.results,g=f.tracks.items[a.selectedTrack],h={name:b,id:c,tracks:[{name:g.name,artist:f.artists[0].name,album:f.name,imageURL:f.images[0].url,trackURL:g.preview_url}]};e.set(c,h),console.log(h)}}]),angular.module("spotsearchAngularApp").controller("PlaylistController",["$scope","$location","$routeParams","localStorageService",function(a,b,c,d){a.playlistId=c.playlistId,a.activePlaylist=null,a.playlists=[],a.playingTrack=0;for(var e=0;e<d.keys().length;e++)a.playlists.push({id:d.keys()[e],name:d.get(d.keys()[e]).name});a.viewPlaylist=function(){a.activePlaylist=d.get(a.playlistId),console.log(a.activePlaylist)},a.changePlaylist=function(){b.path("/playlists/"+a.playlistId)},a.deletePlaylist=function(){d.remove(a.playlistId),b.path("/playlists")},a.deleteTrack=function(b){a.activePlaylist.tracks.splice(b,1),d.set(a.playlistId,a.activePlaylist)},a.playTrack=function(b,c){a.playingTrack=c,a.player.load({src:b}),a.player.play()},"undefined"==typeof a.playlistId?console.log("no playlist"):a.viewPlaylist()}]);